var n=(e="",t={})=>{throw new Error(`[joystick${e?`.${e}`:""}] ${t.message||t.reason||t}`)};var a=e=>{try{return e instanceof Element}catch(t){n("types.isDOM",t)}};var l=e=>{try{return typeof e=="function"}catch(t){n("types.isFunction",t)}};var m=e=>{try{return!!(e&&typeof e=="object"&&!Array.isArray(e))}catch(t){n("types.isObject",t)}};var y=(e={})=>{try{window.joystick._internal.tree={id:e?.id||null,instanceId:e?.instanceId||null,instance:e,children:[]}}catch(t){n("mount.initializeJoystickComponentTree",t)}};var d=()=>typeof window=="undefined";var b=(e="")=>{try{let[t,r]=e?.split(".");return r?window?.joystick?._internal?.queues[t][r]:window?.joystick?._internal?.queues[t]}catch(t){n("processQueue.getQueue",t)}},p=(e="",t=null)=>{try{d()||(b(e)||{}).process(t)}catch(r){n("processQueue",r)}};var f=(e={},t=null)=>{try{return e.innerHTML="",e.appendChild(t),t}catch(r){n("mount.appendToDOM",r)}};var h=(e={})=>{try{return Object.entries(e).map(([t,r])=>{let[i,...o]=t.split(" ");return{type:i.toLowerCase(),selector:o.join(" "),handler:r}})}catch(t){n("component.events.serialize",t)}};var w=(e={},t=[])=>{let r=e.instance.options.events||{};if(Object.keys(r).length>0&&t.push({id:e.id,instanceId:e.instance.instanceId,events:h(r).map(o=>{let s=document.querySelectorAll(`body [js-i="${e.instance.instanceId}"] ${o.selector}`),u=document.querySelectorAll(`body [js-c="${e.id}"] ${o.selector}`);return{...o,eventListener:function(c){Object.defineProperty(c,"target",{value:c.composedPath()[0]}),o.handler(c,e.instance)},elements:s?.length>0?s:u}}),instance:e.instance}),e?.children?.length>0)for(let o=0;o<e?.children?.length;o+=1){let s=e?.children[o];w(s,t)}return t},x=()=>{let e=w(window.joystick._internal.tree,[]);for(let t=0;t<e?.length;t+=1){let r=e[t];for(let i=0;i<r?.events?.length;i+=1){let o=r.events[i];for(let s=0;s<o?.elements?.length;s+=1)o.elements[s].addEventListener(o.type,o.eventListener)}}window.joystick._internal.eventListeners=e};var U=(e=null,t={},r=null)=>{try{l(e)||n("mount","Component to mount must be a function."),m(t)||n("mount","props must be an object."),a(r)||n("mount","target must be a DOM node.");let i=e({props:t});y(i);let o=i.render({mounting:!0});i.lifecycle.onBeforeMount(),p("lifecycle.onBeforeMount"),f(r,o),i.setDOMNodeOnInstance(),i.appendCSSToHead(),i.lifecycle.onMount(),p("lifecycle.onMount"),x()}catch(i){n("mount",i)}};export{U as default};
