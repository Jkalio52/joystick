var i=(t="",e={})=>{throw new Error(`[joystick${t?`.${t}`:""}] ${e.message||e.reason||e}`)};var p=()=>typeof window=="undefined";var m=(t="")=>{try{let[e,r]=t?.split(".");return r?window?.joystick?._internal?.queues[e][r]:window?.joystick?._internal?.queues[e]}catch(e){i("addToQueue.getQueue",e)}},d=(t="",e=null)=>{try{p()||(m(t)||{}).array.push({callback:e})}catch(r){i("addToQueue",r)}};var l=t=>{try{return t instanceof Element}catch(e){i("types.isDOM",e)}};var u=t=>{try{return typeof t=="function"}catch(e){i("types.isFunction",e)}};var y=(t={})=>{try{return Object.entries(t).map(([e,r])=>{let[n,...o]=e.split(" ");return{type:n.toLowerCase(),selector:o.join(" "),handler:r}})}catch(e){i("component.events.serialize",e)}};var f=(t=16)=>{let e=[],r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];for(let n=0;n<t;n++)e.push(r[Math.floor(Math.random()*16)]);return e.join("")};var h=({componentId:t="",instanceId:e="",parentId:r="",selector:n="",element:o=null,eventType:c=null,eventListener:s=null})=>{try{o&&l(o)&&c&&s&&u(s)&&(o.addEventListener(c,s),window.joystick._internal.eventListeners.push({eventId:f(8),selector:n,componentId:t,instanceId:e,parentId:r,element:o,eventType:c,eventListener:s}))}catch(a){i("component.events.addListener",a)}};var w=(t="",e=[],r={},n={})=>{try{for(let o=0;o<e.length;o+=1){let c=e[o];h({componentId:n?.id,instanceId:n.instanceId,parentId:n?.parent?.instanceId,selector:t,element:c,eventType:r.type,eventListener:function(a){Object.defineProperty(a,"target",{value:a.composedPath()[0]}),r.handler(a,n)}})}}catch(o){i("component.events.attachToDOM.attachEventListener",o)}},x=(t=[],e={})=>{try{t.forEach(r=>{d("eventListeners",()=>{let n=`body [js-c="${e.id}"] ${r.selector}`,o=document.querySelectorAll(n);o&&o.length>0&&w(n,o,r,e)})})}catch(r){i("component.events.attachToDOM.queueEventListeners",r)}},b=(t={})=>{try{if(t.lifecycle&&t.lifecycle.onBeforeUnmount&&u(t.lifecycle.onBeforeUnmount)){let e=function(){t.lifecycle.onBeforeUnmount(t)};window.removeEventListener("beforeunload",e),window.addEventListener("beforeunload",e)}}catch(e){i("component.events.attachToDOM.attachOnBeforeUnmount",e)}},I=(t={})=>{try{let e=y(t?.options?.events);b(t),x(e,t)}catch{i("component.events.attachToDOM")}};export{I as default};
