var lr=Object.create;var N=Object.defineProperty;var fr=Object.getOwnPropertyDescriptor;var mr=Object.getOwnPropertyNames;var hr=Object.getPrototypeOf,wr=Object.prototype.hasOwnProperty;var yr=r=>N(r,"__esModule",{value:!0});var xr=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Mr=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of mr(e))!wr.call(r,n)&&n!=="default"&&N(r,n,{get:()=>e[n],enumerable:!(t=fr(e,n))||t.enumerable});return r},Tr=r=>Mr(yr(N(r!=null?lr(hr(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var Q=xr(A=>{(function(r,e){if(typeof define=="function"&&define.amd)define(["exports"],e);else if(typeof A!="undefined")e(A);else{var t={exports:{}};e(t.exports),r.index=t.exports}})(A,function(r){"use strict";function e(s){return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},e(s)}function t(s,i){return i&&(e(i)==="object"||typeof i=="function")?i:n(s)}function n(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function c(s){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},c(s)}function a(s,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(i&&i.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),i&&x(s,i)}function x(s,i){return x=Object.setPrototypeOf||function(l,T){return l.__proto__=T,l},x(s,i)}function p(s,i){if(!(s instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.diff=void 0;var M=function s(i,l){p(this,s),this.type=i,this.path=l?l.toString():""},j=function(s){function i(l,T,d){var F;return p(this,i),F=t(this,c(i).call(this,"E",l)),F.lhs=T,F.rhs=d,F}return a(i,s),i}(M),b=function(s){function i(l,T,d,F){var f;return p(this,i),f=t(this,c(i).call(this,"M",l)),f.item=T,f.lhsIndex=d,f.rhsIndex=F,f}return a(i,s),i}(M),P=function(s){function i(l,T){var d;return p(this,i),d=t(this,c(i).call(this,"D",l)),d.lhs=T,d}return a(i,s),i}(M),_=function(s){function i(l,T){var d;return p(this,i),d=t(this,c(i).call(this,"A",l)),d.rhs=T,d}return a(i,s),i}(M),S=function(s,i){return s?"".concat(s,".").concat(i):i};r.diff=function(i,l){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},d=[],F=T.matchKey,f=T.types||["E","A","D","M"],ur=function(m,u,h,E){m.forEach(function(O,w){var g=u.findIndex(function(y){return y[E]===O[E]});-1<g?(-1<f.indexOf("M")&&w!==g&&d.push(new b(h,O,w,g)),R(O,u[g],S(h,g))):-1<f.indexOf("D")&&d.push(new P(h,O))}),u.forEach(function(O,w){var g=m.findIndex(function(y){return O[E]===y[E]});-1<f.indexOf("A")&&g===-1&&d.push(new _(S(h,w),O))})},R=function(m,u,h){var E=Object.prototype.toString.call(m),O=Object.prototype.toString.call(u);if(-1<f.indexOf("E")&&E!==O)return d.push(new j(h,m,u)),!1;if(E==="[object Object]")Object.getOwnPropertyNames(m).forEach(function(y){Object.prototype.hasOwnProperty.call(u,y)?R(m[y],u[y],S(h,y)):-1<f.indexOf("D")&&d.push(new P(S(h,y),m[y]))}),Object.getOwnPropertyNames(u).forEach(function(y){-1<f.indexOf("A")&&!Object.prototype.hasOwnProperty.call(m,y)&&d.push(new _(S(h,y),u[y]))});else if(E!=="[object Array]")-1<f.indexOf("E")&&m!==u&&d.push(new j(h,m,u));else if(F)ur(m,u,h,F);else{var w=m.length-1,g=u.length-1;if(-1<f.indexOf("D"))for(;w>g;)d.push(new P(S(h,w),m[w--]));if(-1<f.indexOf("A"))for(;g>w;)d.push(new _(S(h,g),u[g--]));for(;0<=w;--w)R(m[w],u[w],S(h,w))}};return R(i,l),d}})});var o=(r="",e={})=>{throw new Error(`[joystick${r?`.${r}`:""}] ${e.message||e.reason||e}`)};var k=()=>typeof window=="undefined";var B=r=>{try{return!!Array.isArray(r)}catch(e){o("types.isArray",e)}};var z=r=>{try{return typeof r=="function"}catch(e){o("types.isFunction",e)}};var I=r=>{try{return!!(r&&typeof r=="object"&&!Array.isArray(r))}catch(e){o("types.isObject",e)}};var D=r=>{try{return typeof r=="string"}catch(e){o("types.isString",e)}};var G=(r=[],e="")=>{try{return(B(r)&&r.find(n=>n?.ssrId===e))?.data||{}}catch(t){o("findComponentDataFromSSR",t)}};var W=Tr(Q());var gr=(r="")=>{try{let[e,t]=r?.split(".");return t?window?.joystick?._internal?.queues[e][t]:window?.joystick?._internal?.queues[e]}catch(e){o("addToQueue.getQueue",e)}},C=(r="",e=null)=>{try{k()||(gr(r)||{}).array.push({callback:e})}catch(t){o("addToQueue",t)}};var V=(r={},e="",t="id")=>{try{let n=r&&r.id;if(I(r)&&n){let c=Object.keys(r);for(let a=0;a<c.length;a+=1){let x=c[a],p=r[x];if(x===t&&p===e)return r;if(x==="children"&&Array.isArray(p))for(let M=0;M<p.length;M+=1){let j=p[M],b=V(j,e,t);if(b!==null)return b}}}return null}catch(n){o("component.findComponentInTree",n)}},L=V;var K=(r={},e="",t="id")=>{try{let n=r&&r.id;if(I(r)&&n){let c=Object.keys(r);for(let a=0;a<c.length;a+=1){let x=c[a],p=r[x];if(x===t&&p===e)return r;if(x==="children"&&Array.isArray(p))for(let M=0;M<p.length;M+=1){let j=p[M],b=K(j,e,t);if(b!==null)return b}}}return null}catch(n){o("component.findComponentInTreeByField",n)}},X=K;var J=(r="",e={},t=null)=>{let n=X(t||window.joystick._internal.tree,r,"instanceId");n&&(n.children=[...n.children||[],e])};var Fr=(r={},e={})=>{try{let t=v(r,{includeActual:!0});return r.dom=t,r.setDOMNodeOnInstance(),r.appendCSSToHead(),e.renderedComponent=r,t.html.wrapped}catch(t){o("component.renderMethods.component.renderForClient",t)}},Or=(r={})=>{try{return r.renderToHTML({ssrTree:r.parent.ssrTree,translations:r.parent.translations,walkingTreeForSSR:r?.parent?.walkingTreeForSSR,dataFromSSR:r.parent?.dataFromSSR}).wrapped}catch(e){o("component.renderMethods.component.renderToHTMLForSSR",e)}},Sr=(r={})=>{try{return r.parent.ssrTree.dataFunctions.push(async()=>{let e=await r.options.data(r.parent.options.api,r.parent.options.req);return r.data=e||{},{componentId:r.id,ssrId:r.ssrId,data:e}}),r.renderToHTML({ssrTree:r?.parent?.ssrTree,translations:r?.parent?.translations,walkingTreeForSSR:r?.parent?.walkingTreeForSSR,dataFromSSR:r?.parent?.dataFromSSR})}catch(e){o("component.renderMethods.component.collectDataFunctionsForSSR",e)}},Er=(r={})=>{try{let e={id:r.id,instanceId:r.instanceId,instance:r,children:[]};J(r.parent.instanceId,e,r.parent&&r.parent.ssrTree||null)}catch(e){o("component.renderMethods.component.handleAddComponentToParent",e)}},br=(r={},e={})=>{try{!r.renderedComponent&&e.options&&e.options.lifecycle&&(e.options.lifecycle.onBeforeMount&&C("lifecycle.onBeforeMount",()=>{e.options.lifecycle.onBeforeMount(e)}),!r.renderedComponent&&e.options.lifecycle.onMount&&C("lifecycle.onMount",()=>{e.options.lifecycle.onMount(e)}))}catch(t){o("component.renderMethods.component.handleLifecycle",t)}},kr=(r={},e={},t={})=>{try{!e.walkingTreeForSSR&&r?.options?.lifecycle?.onUpdateProps&&(0,W.diff)(e?.existingPropsMap,t)?.length>0&&C("lifecycle.onUpdateProps",()=>{let c=e?.existingPropsMap&&e?.existingPropsMap[r.id];r.options.lifecycle.onUpdateProps(c||{},t,r)})}catch(n){o("component.renderMethods.component.handleOnChangeProps",n)}},jr=function(){return function(e=null,t={},n={}){let c=e({props:t,existingStateMap:!n.walkingTreeForSSR&&n?.existingStateMap,url:n.url,translations:n.translations,api:n.options.api,req:n.options.req,dataFromSSR:n?.dataFromSSR});return c.parent=n,kr(c,n,t),C("lifecycle.onMount",()=>{c.setDOMNodeOnInstance()}),br(this,c),Er(c),c.options.data&&c.parent.walkingTreeForSSR&&c.parent.ssrTree.dataFunctions?Sr(c):c.parent&&c.parent.ssrTree?Or(c):Fr(c,this)}},Cr=function(e,t){try{let n=this;return new jr().bind({})(e,t,n)}catch(n){o("component.renderMethods.component",n)}},H=Cr;var Rr=function(e=[],t=null){try{return z(t)&&e&&Array.isArray(e)?e.map((n,c)=>t(n,c)).join(""):""}catch(n){o("component.renderMethods.each",n)}},U=Rr;var Ir=function(e="",t={}){try{let n=k()?this.translations:window.__joystick_i18n__;if(!n||!n[e])return"";let c=Object.entries(t);return c.length>0?c.reduce((a,[x,p])=>a.replace(`{{${x}}}`,p),n[e]):n[e]}catch(n){o("component.renderMethods.i18n",n)}},$=Ir;var Dr=function(e=!1,t=""){try{return e?t:""}catch(n){o("component.renderMethods.when",n)}},q=Dr;var Y={c:H,component:H,e:U,each:U,i:$,i18n:$,w:q,when:q};var Z=(r={},e={})=>{try{return Object.entries(Y).reduce((t,[n,c])=>(t[n]=c.bind({...r,...e}),t),{})}catch(t){o("component.renderMethods.compile",t)}};var rr=(r={})=>{try{return L(window.joystick._internal.tree,r.id)?.children?.reduce((t={},n)=>(t[n?.instance?.id]||(t[n?.instance?.id]=n?.instance?.props),t),{})}catch(e){o("component.render.getExistingPropsMap",e)}};var er=(r={})=>{try{return L(window.joystick._internal.tree,r.id)?.children?.reduce((t={},n)=>(t[n?.instance?.id]||(t[n?.instance?.id]=n?.instance?.state),t),{})}catch(e){o("component.render.getExistingStateMap",e)}};var tr=new RegExp(/\<\!\-\-(?:.|\n|\r)*?-->/g),nr=new RegExp(/(\r\n|\n|\r)/gm,"");var Ar=(r="")=>{try{return r.replace(nr,"")}catch(e){o("component.render.sanitizeHTML.removeNewLineCharacters",e)}},Lr=(r="")=>{try{return(r.match(tr)||[]).forEach(t=>{r=r.replace(t,"")}),r}catch(e){o("component.render.sanitizeHTML.removeCommentedCode",e)}},or=(r="")=>{try{let e=`${r}`;return e=Lr(e),e=Ar(e),e}catch(e){o("component.render.sanitizeHTML",e)}};var ir=(r={},e="")=>{try{let{wrapper:t=null,ssrId:n=null,id:c=null,instanceId:a=null}=r;return`<div ${t?.id?`id="${t.id}" `:""}${t?.classList?`class="${t.classList?.join(" ")}" `:""}js-ssrId="${n}" js-c="${c}" js-i="${a}">${e}</div>`}catch(t){o("component.render.wrapHTML",t)}};var cr=(r={},e={})=>{try{e?.dataFromSSR&&(r.data=G(e.dataFromSSR,r.ssrId)||{});let t=Z({...r,existingPropsMap:k()?{}:rr(r),existingStateMap:k()?{}:er(r),ssrTree:e?.ssrTree,translations:e?.translations||r.translations||{},walkingTreeForSSR:e?.walkingTreeForSSR,dataFromSSR:e?.dataFromSSR}),n=r.options.render({...r||{},setState:r.setState.bind(r),...t||{}}),c=or(n),a=ir(r,c);return{unwrapped:c,wrapped:a}}catch(t){o("component.render.toHTML",t)}};var vr=(r={})=>{try{return Object.values(r).reduce((e={},t)=>(e[t.name]=t.value,e),{})}catch(e){o("component.virtualDOM.build.parseAttributeMap",e)}},sr=(r="")=>{try{let e=r.tagName&&r.tagName.toLowerCase()||"text",t={tagName:e,attributes:vr(r.attributes),children:[].map.call(r.childNodes,n=>sr(n))};return e==="text"&&(t=r.textContent),t}catch(e){o("component.virtualDOM.build.buildVirtualDOMTree",e)}},Pr=(r="",e="")=>{try{if(!r||!D(r))return null;let t=document.createElement("div");return t.setAttribute("js-c",e),t.innerHTML=r,t}catch(t){o("component.virtualDOM.build.buildVirtualDOM",t)}},ar=(r="",e="")=>{try{let t=Pr(r,e);return sr(t)}catch(t){o("component.virtualDOM.build",t)}};var _r=(r={})=>{try{let e=document.createElement(r.tagName),t=Object.entries(r.attributes);for(let n=0;n<t.length;n+=1){let[c,a]=t[n];e.setAttribute(c,a)}for(let n=0;n<r?.children?.length;n+=1){let c=r?.children[n];if(c){let a=dr(c);e.appendChild(a)}}return e}catch(e){o("component.virtualDOM.renderTreeToDOM.renderElement",e)}},dr=(r=null)=>{try{return D(r)?document.createTextNode(r):_r(r)}catch(e){o("component.virtualDOM.renderTreeToDOM",e)}},pr=dr;var v=(r={},e={})=>{try{let t=cr(r),n=ar(t.unwrapped,r.id),c=e.includeActual&&n?pr(n):null;return{html:t,virtual:n,actual:c}}catch(t){o("component.render.getUpdatedDOM",t)}};var st=(r={})=>{try{let e=v(r,{includeActual:!0});return r.dom=e,e.actual}catch(e){o("component.render.forMount",e)}};export{st as default};
